+++
title = "从源代码构建Onecloud"
date = 2020-06-19T21:42:01+08:00
draft = false

# Tags and categories
# For example, use `tags = []` for no tags, or the form `tags = ["A Tag", "Another Tag"]` for one or more tags.
tags = ["CMP"]
categories = []

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder. 
[image]
  # Caption (optional)
  caption = ""

  # Focal point (optional)
  # Options: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight
  focal_point = ""
+++

## 系统设置

`/etc/yum.conf`

```
obsoletes=0
```

obsoletes=1: 安装k8s 1.15.8会报一个依赖错误


## 安装ansible

```
sudo yum install epel-release
sudo yum install python-pip
pip install ansible
```

## 安装kubelet（可选）

[OCADM](https://github.com/yunionio/ocadm)创建K8S的前提条件是kebelet正常工作

[安装kubelet](https://wubigo.com/post/kubeadm-note-update/)

## OCBOOT

```
git clone https://github.com/yunionio/ocboot.git
cd ocboot
./run.py ./config-allinone.yml
```

`allinone.yml`

```
mariadb_node:
  use_local: true
  hostname: 192.168.137.190
  user: root
  db_user: root
  db_password: qwe123
primary_master_node:
#master_node:
  use_local: true
  hostname: 192.168.137.190
  user: root
  db_host: 192.168.137.190
  db_user: root
  db_password: qwe123
  onecloud_user: demo
  onecloud_user_password: demo@123
  controlplane_host: 192.168.137.190
  controlplane_port: "6443"
  as_host: true
  registry_mirrors:
  - https://lje6zxpk.mirror.aliyuncs.com
```

-  安装制定版本

```
onecloud_version: v3.2.1
```

https://github.com/yunionio/ocboot/blob/master/onecloud/roles/common/tasks/main.yml

```
url: https://iso.yunion.cn/yumrepo-3.2/yunion.repo
```



## HOST

```
kubectl logs  -n onecloud default-host-4fgxx > /tmp/host.log

cat /var/lib/dhclient/dhclient-b17b6243-80ba-4e51-bb07-753bfb756270-ens33.lease
```





##  OCBOOT 

```
ansible-playbook -e ANSIBLE_HOST_KEY_CHECKING=False -i /root/ocboot/onecloud/zz_generated.hosts /root/ocboot/onecloud/zz_generated.site.yml -vv


TASK [primary-master-node : Update onecloud user demo password to demo@123]


[oc-upload-config] storing the configuration used in ConfigMap "ocadm-config" in the "kube-system" Namespace
[addons] Applied essential addon: CoreDNS
[addons] Applied essential addon: kube-proxy
[oc-addons] Applied addon: calico
[oc-addons] Applied addon: local-path-provisioner
[oc-addons] Applied addon: traefik
[oc-addons] Applied addon: onecloud-operator

```

ocboot -> ocadm -> 部署k8s 和 [onecloud-operator](https://github.com/yunionio/onecloud-operator/blob/master/docs/intro.md)

ocadm的addon阶段里面定义了onecloud-operator

operator收到一个 OnecloudCluster 实例创建的请求，就开始搭建 onecloud 的 keystone、region、glance、web前端等各个服务

```
kubectl -n kube-system get cm ocadm-config -oyaml
```

## ISO安装

`/opt/yunion/upgrade/config.yml`

```
cat /opt/yunion/upgrade/config.yml |grep db
```

## disable host-agent

```
ocadm node disable-host-agent
ocadm baremetal disable
```

## 说明

- operator 本身是由ocadm 的工具安装的

ocadm init 命令就会安装 operator

[代码](https://github.com/yunionio/ocadm/blob/master/pkg/phases/addons/onecloudoperator/template.go)

- ocboot安装k8s

ansible任务["Use ocadm init first master node"](https://github.com/yunionio/ocboot/blob/cc8d3dd2ca5700f146646b9f2083958f600395ec/onecloud/roles/primary-master-node/tasks/main.yml#L74) 部署 k8s 集群，并安装对应的 operator 等插件




```

[root@localhost ocboot]# ansible-playbook -e ANSIBLE_HOST_KEY_CHECKING=False -i /root/ocboot/onecloud/zz_generated.hosts /root/ocboot/onecloud/zz_generated.site.yml -vv
ansible-playbook 2.9.9
  config file = /etc/ansible/ansible.cfg
  configured module search path = [u'/root/.ansible/plugins/modules', u'/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python2.7/site-packages/ansible
  executable location = /usr/bin/ansible-playbook
  python version = 2.7.5 (default, Apr  2 2020, 13:16:51) [GCC 4.8.5 20150623 (Red Hat 4.8.5-39)]
Using /etc/ansible/ansible.cfg as config file

PLAYBOOK: zz_generated.site.yml *******************************************************************************************************
2 plays in /root/ocboot/onecloud/zz_generated.site.yml

PLAY [mariadb_node] *******************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************
task path: /root/ocboot/onecloud/zz_generated.site.yml:1
ok: [127.0.0.1]
META: ran handlers

TASK [mariadb : Install mariadb] ******************************************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:1
ok: [127.0.0.1] => {"changed": false, "msg": "", "rc": 0, "results": ["1:mariadb-server-5.5.65-1.el7.x86_64 providing mariadb-server is already installed"]}

TASK [mariadb : Install MySQL-python] *************************************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:6
ok: [127.0.0.1] => {"changed": false, "msg": "", "rc": 0, "results": ["MySQL-python-1.2.5-1.el7.x86_64 providing MySQL-python is already installed"]}

TASK [mariadb : Copy my.cnf] **********************************************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:11
ok: [127.0.0.1] => {"changed": false, "checksum": "e079b173a071cae24cec85746edacb4983f3b1d0", "dest": "/etc/my.cnf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/my.cnf", "size": 674, "state": "file", "uid": 0}

TASK [mariadb : Enable mariadb] *******************************************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:16
ok: [127.0.0.1] => {"changed": false, "enabled": true, "name": "mariadb", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2020-06-19 04:14:47 EDT", "ActiveEnterTimestampMonotonic": "14040115", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "tmp.mount system.slice systemd-journald.socket syslog.target network.target -.mount basic.target", "AllowIsolate": "no", "AmbientCapabilities": "0", "AssertResult": "yes", "AssertTimestamp": "Fri 2020-06-19 04:14:43 EDT", "AssertTimestampMonotonic": "9998771", "Before": "multi-user.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "18446744073709551615", "CPUAccounting": "no", "CPUQuotaPerSecUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "18446744073709551615", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "18446744073709551615", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2020-06-19 04:14:43 EDT", "ConditionTimestampMonotonic": "9998771", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/mariadb.service", "ControlPID": "0", "DefaultDependencies": "yes", "Delegate": "no", "Description": "MariaDB database server", "DevicePolicy": "auto", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "1188", "ExecMainStartTimestamp": "Fri 2020-06-19 04:14:44 EDT", "ExecMainStartTimestampMonotonic": "10605707", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/mysqld_safe ; argv[]=/usr/bin/mysqld_safe --basedir=/usr ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPost": "{ path=/usr/libexec/mariadb-wait-ready ; argv[]=/usr/libexec/mariadb-wait-ready $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartPre": "{ path=/usr/libexec/mariadb-prepare-db-dir ; argv[]=/usr/libexec/mariadb-prepare-db-dir %n ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/usr/lib/systemd/system/mariadb.service", "Group": "mysql", "GuessMainPID": "yes", "IOScheduling": "0", "Id": "mariadb.service", "IgnoreOnIsolate": "no", "IgnoreOnSnapshot": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Fri 2020-06-19 04:14:43 EDT", "InactiveExitTimestampMonotonic": "10006574", "JobTimeoutAction": "none", "JobTimeoutUSec": "0", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "18446744073709551615", "LimitCORE": "18446744073709551615", "LimitCPU": "18446744073709551615", "LimitDATA": "18446744073709551615", "LimitFSIZE": "18446744073709551615", "LimitLOCKS": "18446744073709551615", "LimitMEMLOCK": "65536", "LimitMSGQUEUE": "819200", "LimitNICE": "0", "LimitNOFILE": "4096", "LimitNPROC": "31119", "LimitRSS": "18446744073709551615", "LimitRTPRIO": "0", "LimitRTTIME": "18446744073709551615", "LimitSIGPENDING": "31119", "LimitSTACK": "18446744073709551615", "LoadState": "loaded", "MainPID": "1188", "MemoryAccounting": "no", "MemoryCurrent": "105254912", "MemoryLimit": "18446744073709551615", "MountFlags": "0", "Names": "mariadb.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "PrivateDevices": "no", "PrivateNetwork": "no", "PrivateTmp": "yes", "ProtectHome": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "Requires": "system.slice basic.target -.mount", "RequiresMountsFor": "/var/tmp", "Restart": "no", "RestartUSec": "100ms", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitInterval": "10000000", "StartupBlockIOWeight": "18446744073709551615", "StartupCPUShares": "18446744073709551615", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "no", "TasksCurrent": "20", "TasksMax": "18446744073709551615", "TimeoutStartUSec": "5min", "TimeoutStopUSec": "5min", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UMask": "0022", "UnitFilePreset": "disabled", "UnitFileState": "enabled", "User": "mysql", "WantedBy": "multi-user.target", "WatchdogTimestamp": "Fri 2020-06-19 04:14:44 EDT", "WatchdogTimestampMonotonic": "10605863", "WatchdogUSec": "0"}}

TASK [mariadb : Change root password] *************************************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:22
[WARNING]: Module did not set no_log for update_password
ok: [127.0.0.1] => {"changed": false, "failed_when_result": false, "msg": "unable to connect to database, check login_user and login_password are correct or /root/.my.cnf has the credentials. Exception message: (1045, \"Access denied for user 'root'@'localhost' (using password: NO)\")"}

TASK [mariadb : Allow remote root access with grant priv] *****************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:30
ok: [127.0.0.1] => {"changed": false, "msg": "User unchanged", "user": "root"}

TASK [mariadb : Remove all anonymous user accounts] ***********************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:40
ok: [127.0.0.1] => {"changed": false, "msg": "User doesn't exist", "user": ""}

TASK [mariadb : Remove test database] *************************************************************************************************
task path: /root/ocboot/onecloud/roles/mariadb/tasks/main.yml:48
ok: [127.0.0.1] => {"changed": false, "db": "test", "db_list": ["test"]}
META: ran handlers
META: ran handlers

PLAY [primary_master_node] ************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************
task path: /root/ocboot/onecloud/zz_generated.site.yml:4
ok: [127.0.0.1]
META: ran handlers

TASK [Do common setup] ****************************************************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:1

TASK [common : Install yum utils] *****************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:3
[DEPRECATION WARNING]: Invoking "yum" only once while using a loop via squash_actions is deprecated. Instead of using a loop to supply
 multiple items and specifying `name: "{{ item }}"`, please use `name: ['yum-utils', 'bash-completion', 'epel-release']` and remove
the loop. This feature will be removed in version 2.11. Deprecation warnings can be disabled by setting deprecation_warnings=False in
ansible.cfg.
ok: [127.0.0.1] => (item=[u'yum-utils', u'bash-completion', u'epel-release']) => {"ansible_loop_var": "item", "changed": false, "changes": {"installed": [], "updated": []}, "item": ["yum-utils", "bash-completion", "epel-release"], "msg": "", "obsoletes": {"kubernetes-cni": {"dist": "x86_64", "repo": "@kubernetes", "version": "0.7.5-0"}}, "rc": 0, "results": ["All packages providing yum-utils are up to date", "All packages providing bash-completion are up to date", "All packages providing epel-release are up to date", ""]}

TASK [common : Add yunion rpm repository] *********************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:10
ok: [127.0.0.1] => {"changed": false, "checksum_dest": "2f42e4a4f882cad83d59c75b5f6f3df278d6a574", "checksum_src": "2f42e4a4f882cad83d59c75b5f6f3df278d6a574", "dest": "/etc/yum.repos.d/yunion.repo", "elapsed": 0, "gid": 0, "group": "root", "md5sum": "7f952d8ebe445afc837adc4dec8e5a4c", "mode": "0644", "msg": "OK (165 bytes)", "owner": "root", "size": 165, "src": "/root/.ansible/tmp/ansible-tmp-1592572330.52-54744-188320608425950/tmp70g6X8", "state": "file", "status_code": 200, "uid": 0, "url": "https://iso.yunion.cn/yumrepo-3.1/yunion.repo"}

TASK [common : Install yunion common packages] ****************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:16
[DEPRECATION WARNING]: Invoking "yum" only once while using a loop via squash_actions is deprecated. Instead of using a loop to supply
 multiple items and specifying `name: "{{ item }}"`, please use `name: ['epel-release', 'libaio', 'jq', 'libusb', 'lvm2', 'nc', 'ntp',
 'fetchclient', 'fuse', 'fuse-devel', 'fuse-libs', 'oniguruma', 'pciutils', 'spice', 'spice-protocol', 'sysstat', 'tcpdump',
'telegraf-1.5.18-1', 'usbredir', 'yunion-qemu-2.12.1', 'yunion-ocadm', 'yunion-climc', 'yunion-executor-server',
'kernel-3.10.0-1062.4.3.el7.yn20191203', 'kernel-devel-3.10.0-1062.4.3.el7.yn20191203', 'kernel-
headers-3.10.0-1062.4.3.el7.yn20191203', 'kmod-openvswitch-2.9.6-1.el7', 'openvswitch-2.9.6-1.el7', 'net-tools']` and remove the loop.
 This feature will be removed in version 2.11. Deprecation warnings can be disabled by setting deprecation_warnings=False in
ansible.cfg.
ok: [127.0.0.1] => (item=[u'epel-release', u'libaio', u'jq', u'libusb', u'lvm2', u'nc', u'ntp', u'fetchclient', u'fuse', u'fuse-devel', u'fuse-libs', u'oniguruma', u'pciutils', u'spice', u'spice-protocol', u'sysstat', u'tcpdump', u'telegraf-1.5.18-1', u'usbredir', u'yunion-qemu-2.12.1', u'yunion-ocadm', u'yunion-climc', u'yunion-executor-server', u'kernel-3.10.0-1062.4.3.el7.yn20191203', u'kernel-devel-3.10.0-1062.4.3.el7.yn20191203', u'kernel-headers-3.10.0-1062.4.3.el7.yn20191203', u'kmod-openvswitch-2.9.6-1.el7', u'openvswitch-2.9.6-1.el7', u'net-tools']) => {"ansible_loop_var": "item", "changed": false, "item": ["epel-release", "libaio", "jq", "libusb", "lvm2", "nc", "ntp", "fetchclient", "fuse", "fuse-devel", "fuse-libs", "oniguruma", "pciutils", "spice", "spice-protocol", "sysstat", "tcpdump", "telegraf-1.5.18-1", "usbredir", "yunion-qemu-2.12.1", "yunion-ocadm", "yunion-climc", "yunion-executor-server", "kernel-3.10.0-1062.4.3.el7.yn20191203", "kernel-devel-3.10.0-1062.4.3.el7.yn20191203", "kernel-headers-3.10.0-1062.4.3.el7.yn20191203", "kmod-openvswitch-2.9.6-1.el7", "openvswitch-2.9.6-1.el7", "net-tools"], "msg": "", "rc": 0, "results": ["epel-release-7-12.noarch providing epel-release is already installed", "libaio-0.3.109-13.el7.x86_64 providing libaio is already installed", "jq-1.6-1.el7.x86_64 providing jq is already installed", "1:libusb-0.1.4-3.el7.x86_64 providing libusb is already installed", "7:lvm2-2.02.186-7.el7.x86_64 providing lvm2 is already installed", "2:nmap-ncat-6.40-19.el7.x86_64 providing nc is already installed", "ntp-4.2.6p5-29.el7.centos.x86_64 providing ntp is already installed", "fetchclient-1.0.0-3.el7.centos.x86_64 providing fetchclient is already installed", "fuse-2.9.2-11.el7.x86_64 providing fuse is already installed", "fuse-devel-2.9.2-11.el7.x86_64 providing fuse-devel is already installed", "fuse-libs-2.9.2-11.el7.x86_64 providing fuse-libs is already installed", "oniguruma-5.9.5-3.el7.x86_64 providing oniguruma is already installed", "pciutils-3.5.1-3.el7.x86_64 providing pciutils is already installed", "spice-0.13.3-1.el7.centos.x86_64 providing spice is already installed", "spice-protocol-0.12.14-1.el7.noarch providing spice-protocol is already installed", "sysstat-10.1.5-19.el7.x86_64 providing sysstat is already installed", "14:tcpdump-4.9.2-4.el7_7.1.x86_64 providing tcpdump is already installed", "telegraf-1.5.18-1.x86_64 providing telegraf-1.5.18-1 is already installed", "usbredir-0.7.1-3.el7.x86_64 providing usbredir is already installed", "yunion-qemu-2.12.1-2.12.1-1.el7.centos.x86_64 providing yunion-qemu-2.12.1 is already installed", "yunion-ocadm-3.1.9_20200609.1-1.x86_64 providing yunion-ocadm is already installed", "yunion-climc-v3.1.9.20200609.1-20060920.x86_64 providing yunion-climc is already installed", "yunion-executor-server-2.10.20190527.0-19120916.x86_64 providing yunion-executor-server is already installed", "kernel-3.10.0-1062.4.3.el7.yn20191203.x86_64 providing kernel-3.10.0-1062.4.3.el7.yn20191203 is already installed", "kernel-devel-3.10.0-1062.4.3.el7.yn20191203.x86_64 providing kernel-devel-3.10.0-1062.4.3.el7.yn20191203 is already installed", "kernel-headers-3.10.0-1062.4.3.el7.yn20191203.x86_64 providing kernel-headers-3.10.0-1062.4.3.el7.yn20191203 is already installed", "kmod-openvswitch-2.9.6-1.el7.x86_64 providing kmod-openvswitch-2.9.6-1.el7 is already installed", "openvswitch-2.9.6-1.el7.x86_64 providing openvswitch-2.9.6-1.el7 is already installed", "net-tools-2.0-0.25.20131004git.el7.x86_64 providing net-tools is already installed"]}

TASK [common : Turn off selinux] ******************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:49
ok: [127.0.0.1] => {"changed": false, "configfile": "/etc/selinux/config", "msg": "", "policy": "targeted", "reboot_required": false, "state": "disabled"}

TASK [common : Gather service facts] **************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:53
ok: [127.0.0.1] => {"ansible_facts": {"services": {"NetworkManager-dispatcher.service": {"name": "NetworkManager-dispatcher.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "NetworkManager-wait-online.service": {"name": "NetworkManager-wait-online.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "NetworkManager.service": {"name": "NetworkManager.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "arp-ethers.service": {"name": "arp-ethers.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "auditd.service": {"name": "auditd.service", "source": "systemd", "state": "running", "status": "enabled"}, "autovt@.service": {"name": "autovt@.service", "source": "systemd", "state": "unknown", "status": "enabled"}, "blk-availability.service": {"name": "blk-availability.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "brandbot.service": {"name": "brandbot.service", "source": "systemd", "state": "unknown", "status": "static"}, "chrony-dnssrv@.service": {"name": "chrony-dnssrv@.service", "source": "systemd", "state": "unknown", "status": "static"}, "chrony-wait.service": {"name": "chrony-wait.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "chronyd.service": {"name": "chronyd.service", "source": "systemd", "state": "running", "status": "enabled"}, "conntrackd.service": {"name": "conntrackd.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "console-getty.service": {"name": "console-getty.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "console-shell.service": {"name": "console-shell.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "container-getty@.service": {"name": "container-getty@.service", "source": "systemd", "state": "unknown", "status": "static"}, "containerd.service": {"name": "containerd.service", "source": "systemd", "state": "running", "status": "disabled"}, "cpupower.service": {"name": "cpupower.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "crond.service": {"name": "crond.service", "source": "systemd", "state": "running", "status": "enabled"}, "dbus-org.freedesktop.hostname1.service": {"name": "dbus-org.freedesktop.hostname1.service", "source": "systemd", "state": "unknown", "status": "static"}, "dbus-org.freedesktop.import1.service": {"name": "dbus-org.freedesktop.import1.service", "source": "systemd", "state": "unknown", "status": "static"}, "dbus-org.freedesktop.locale1.service": {"name": "dbus-org.freedesktop.locale1.service", "source": "systemd", "state": "unknown", "status": "static"}, "dbus-org.freedesktop.login1.service": {"name": "dbus-org.freedesktop.login1.service", "source": "systemd", "state": "unknown", "status": "static"}, "dbus-org.freedesktop.machine1.service": {"name": "dbus-org.freedesktop.machine1.service", "source": "systemd", "state": "unknown", "status": "static"}, "dbus-org.freedesktop.timedate1.service": {"name": "dbus-org.freedesktop.timedate1.service", "source": "systemd", "state": "unknown", "status": "static"}, "dbus.service": {"name": "dbus.service", "source": "systemd", "state": "running", "status": "static"}, "debug-shell.service": {"name": "debug-shell.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "dm-event.service": {"name": "dm-event.service", "source": "systemd", "state": "stopped", "status": "static"}, "docker.service": {"name": "docker.service", "source": "systemd", "state": "running", "status": "enabled"}, "dracut-cmdline.service": {"name": "dracut-cmdline.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-initqueue.service": {"name": "dracut-initqueue.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-mount.service": {"name": "dracut-mount.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-pre-mount.service": {"name": "dracut-pre-mount.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-pre-pivot.service": {"name": "dracut-pre-pivot.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-pre-trigger.service": {"name": "dracut-pre-trigger.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-pre-udev.service": {"name": "dracut-pre-udev.service", "source": "systemd", "state": "stopped", "status": "static"}, "dracut-shutdown.service": {"name": "dracut-shutdown.service", "source": "systemd", "state": "stopped", "status": "static"}, "ebtables.service": {"name": "ebtables.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "emergency.service": {"name": "emergency.service", "source": "systemd", "state": "stopped", "status": "static"}, "firewalld.service": {"name": "firewalld.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "fstrim.service": {"name": "fstrim.service", "source": "systemd", "state": "unknown", "status": "static"}, "getty@.service": {"name": "getty@.service", "source": "systemd", "state": "unknown", "status": "enabled"}, "getty@tty1.service": {"name": "getty@tty1.service", "source": "systemd", "state": "running", "status": "unknown"}, "halt-local.service": {"name": "halt-local.service", "source": "systemd", "state": "unknown", "status": "static"}, "initrd-cleanup.service": {"name": "initrd-cleanup.service", "source": "systemd", "state": "stopped", "status": "static"}, "initrd-parse-etc.service": {"name": "initrd-parse-etc.service", "source": "systemd", "state": "stopped", "status": "static"}, "initrd-switch-root.service": {"name": "initrd-switch-root.service", "source": "systemd", "state": "stopped", "status": "static"}, "initrd-udevadm-cleanup-db.service": {"name": "initrd-udevadm-cleanup-db.service", "source": "systemd", "state": "stopped", "status": "static"}, "iprdump.service": {"name": "iprdump.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "iprinit.service": {"name": "iprinit.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "iprupdate.service": {"name": "iprupdate.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "ipvsadm.service": {"name": "ipvsadm.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "irqbalance.service": {"name": "irqbalance.service", "source": "systemd", "state": "running", "status": "enabled"}, "kdump.service": {"name": "kdump.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "kmod-static-nodes.service": {"name": "kmod-static-nodes.service", "source": "systemd", "state": "stopped", "status": "static"}, "kubelet.service": {"name": "kubelet.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "lvm2-lvmetad.service": {"name": "lvm2-lvmetad.service", "source": "systemd", "state": "running", "status": "static"}, "lvm2-lvmpolld.service": {"name": "lvm2-lvmpolld.service", "source": "systemd", "state": "stopped", "status": "static"}, "lvm2-monitor.service": {"name": "lvm2-monitor.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "lvm2-pvscan@.service": {"name": "lvm2-pvscan@.service", "source": "systemd", "state": "unknown", "status": "static"}, "lvm2-pvscan@8:2.service": {"name": "lvm2-pvscan@8:2.service", "source": "systemd", "state": "stopped", "status": "unknown"}, "mariadb.service": {"name": "mariadb.service", "source": "systemd", "state": "running", "status": "enabled"}, "messagebus.service": {"name": "messagebus.service", "source": "systemd", "state": "unknown", "status": "static"}, "microcode.service": {"name": "microcode.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "netconsole": {"name": "netconsole", "source": "sysv", "state": "stopped", "status": "disabled"}, "network": {"name": "network", "source": "sysv", "state": "running", "status": "enabled"}, "network.service": {"name": "network.service", "source": "systemd", "state": "running", "status": "unknown"}, "ntpd.service": {"name": "ntpd.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "ntpdate.service": {"name": "ntpdate.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "openvswitch.service": {"name": "openvswitch.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "ovs-delete-transient-ports.service": {"name": "ovs-delete-transient-ports.service", "source": "systemd", "state": "unknown", "status": "static"}, "ovs-vswitchd.service": {"name": "ovs-vswitchd.service", "source": "systemd", "state": "unknown", "status": "static"}, "ovsdb-server.service": {"name": "ovsdb-server.service", "source": "systemd", "state": "unknown", "status": "static"}, "plymouth-halt.service": {"name": "plymouth-halt.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "plymouth-kexec.service": {"name": "plymouth-kexec.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "plymouth-poweroff.service": {"name": "plymouth-poweroff.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "plymouth-quit-wait.service": {"name": "plymouth-quit-wait.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "plymouth-quit.service": {"name": "plymouth-quit.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "plymouth-read-write.service": {"name": "plymouth-read-write.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "plymouth-reboot.service": {"name": "plymouth-reboot.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "plymouth-start.service": {"name": "plymouth-start.service", "source": "systemd", "state": "stopped", "status": "disabled"}, "plymouth-switch-root.service": {"name": "plymouth-switch-root.service", "source": "systemd", "state": "stopped", "status": "static"}, "polkit.service": {"name": "polkit.service", "source": "systemd", "state": "running", "status": "static"}, "postfix.service": {"name": "postfix.service", "source": "systemd", "state": "running", "status": "enabled"}, "quotaon.service": {"name": "quotaon.service", "source": "systemd", "state": "unknown", "status": "static"}, "rc-local.service": {"name": "rc-local.service", "source": "systemd", "state": "stopped", "status": "static"}, "rdisc.service": {"name": "rdisc.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "rescue.service": {"name": "rescue.service", "source": "systemd", "state": "stopped", "status": "static"}, "rhel-autorelabel-mark.service": {"name": "rhel-autorelabel-mark.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-autorelabel.service": {"name": "rhel-autorelabel.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-configure.service": {"name": "rhel-configure.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-dmesg.service": {"name": "rhel-dmesg.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-domainname.service": {"name": "rhel-domainname.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-import-state.service": {"name": "rhel-import-state.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-loadmodules.service": {"name": "rhel-loadmodules.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rhel-readonly.service": {"name": "rhel-readonly.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "rsyncd.service": {"name": "rsyncd.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "rsyncd@.service": {"name": "rsyncd@.service", "source": "systemd", "state": "unknown", "status": "static"}, "rsyslog.service": {"name": "rsyslog.service", "source": "systemd", "state": "running", "status": "enabled"}, "selinux-policy-migrate-local-changes@.service": {"name": "selinux-policy-migrate-local-changes@.service", "source": "systemd", "state": "unknown", "status": "static"}, "selinux-policy-migrate-local-changes@targeted.service": {"name": "selinux-policy-migrate-local-changes@targeted.service", "source": "systemd", "state": "stopped", "status": "unknown"}, "serial-getty@.service": {"name": "serial-getty@.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "sshd-keygen.service": {"name": "sshd-keygen.service", "source": "systemd", "state": "stopped", "status": "static"}, "sshd.service": {"name": "sshd.service", "source": "systemd", "state": "running", "status": "enabled"}, "sshd@.service": {"name": "sshd@.service", "source": "systemd", "state": "unknown", "status": "static"}, "svnserve.service": {"name": "svnserve.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "sysstat.service": {"name": "sysstat.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "systemd-ask-password-console.service": {"name": "systemd-ask-password-console.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-ask-password-plymouth.service": {"name": "systemd-ask-password-plymouth.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-ask-password-wall.service": {"name": "systemd-ask-password-wall.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-backlight@.service": {"name": "systemd-backlight@.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-binfmt.service": {"name": "systemd-binfmt.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-bootchart.service": {"name": "systemd-bootchart.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "systemd-firstboot.service": {"name": "systemd-firstboot.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-fsck-root.service": {"name": "systemd-fsck-root.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-fsck@.service": {"name": "systemd-fsck@.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-halt.service": {"name": "systemd-halt.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-hibernate-resume@.service": {"name": "systemd-hibernate-resume@.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-hibernate.service": {"name": "systemd-hibernate.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-hostnamed.service": {"name": "systemd-hostnamed.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-hwdb-update.service": {"name": "systemd-hwdb-update.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-hybrid-sleep.service": {"name": "systemd-hybrid-sleep.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-importd.service": {"name": "systemd-importd.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-initctl.service": {"name": "systemd-initctl.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-journal-catalog-update.service": {"name": "systemd-journal-catalog-update.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-journal-flush.service": {"name": "systemd-journal-flush.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-journald.service": {"name": "systemd-journald.service", "source": "systemd", "state": "running", "status": "static"}, "systemd-kexec.service": {"name": "systemd-kexec.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-localed.service": {"name": "systemd-localed.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-logind.service": {"name": "systemd-logind.service", "source": "systemd", "state": "running", "status": "static"}, "systemd-machine-id-commit.service": {"name": "systemd-machine-id-commit.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-machined.service": {"name": "systemd-machined.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-modules-load.service": {"name": "systemd-modules-load.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-nspawn@.service": {"name": "systemd-nspawn@.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "systemd-poweroff.service": {"name": "systemd-poweroff.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-quotacheck.service": {"name": "systemd-quotacheck.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-random-seed.service": {"name": "systemd-random-seed.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-readahead-collect.service": {"name": "systemd-readahead-collect.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "systemd-readahead-done.service": {"name": "systemd-readahead-done.service", "source": "systemd", "state": "stopped", "status": "indirect"}, "systemd-readahead-drop.service": {"name": "systemd-readahead-drop.service", "source": "systemd", "state": "unknown", "status": "enabled"}, "systemd-readahead-replay.service": {"name": "systemd-readahead-replay.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "systemd-reboot.service": {"name": "systemd-reboot.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-remount-fs.service": {"name": "systemd-remount-fs.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-rfkill@.service": {"name": "systemd-rfkill@.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-shutdownd.service": {"name": "systemd-shutdownd.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-suspend.service": {"name": "systemd-suspend.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-sysctl.service": {"name": "systemd-sysctl.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-timedated.service": {"name": "systemd-timedated.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-tmpfiles-clean.service": {"name": "systemd-tmpfiles-clean.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-tmpfiles-setup-dev.service": {"name": "systemd-tmpfiles-setup-dev.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-tmpfiles-setup.service": {"name": "systemd-tmpfiles-setup.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-udev-settle.service": {"name": "systemd-udev-settle.service", "source": "systemd", "state": "unknown", "status": "static"}, "systemd-udev-trigger.service": {"name": "systemd-udev-trigger.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-udevd.service": {"name": "systemd-udevd.service", "source": "systemd", "state": "running", "status": "static"}, "systemd-update-done.service": {"name": "systemd-update-done.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-update-utmp-runlevel.service": {"name": "systemd-update-utmp-runlevel.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-update-utmp.service": {"name": "systemd-update-utmp.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-user-sessions.service": {"name": "systemd-user-sessions.service", "source": "systemd", "state": "stopped", "status": "static"}, "systemd-vconsole-setup.service": {"name": "systemd-vconsole-setup.service", "source": "systemd", "state": "stopped", "status": "static"}, "tcsd.service": {"name": "tcsd.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "teamd@.service": {"name": "teamd@.service", "source": "systemd", "state": "unknown", "status": "static"}, "telegraf.service": {"name": "telegraf.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "tuned.service": {"name": "tuned.service", "source": "systemd", "state": "running", "status": "enabled"}, "vgauthd.service": {"name": "vgauthd.service", "source": "systemd", "state": "running", "status": "enabled"}, "vmtoolsd-init.service": {"name": "vmtoolsd-init.service", "source": "systemd", "state": "stopped", "status": "enabled"}, "vmtoolsd.service": {"name": "vmtoolsd.service", "source": "systemd", "state": "running", "status": "enabled"}, "wpa_supplicant.service": {"name": "wpa_supplicant.service", "source": "systemd", "state": "unknown", "status": "disabled"}, "yunion-executor.service": {"name": "yunion-executor.service", "source": "systemd", "state": "running", "status": "enabled"}}}, "changed": false}

TASK [common : Disable systemd services] **********************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:56
ok: [127.0.0.1] => (item=firewalld) => {"ansible_loop_var": "item", "changed": false, "enabled": false, "item": "firewalld", "name": "firewalld", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "polkit.service system.slice basic.target dbus.service", "AllowIsolate": "no", "AmbientCapabilities": "0", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target docker.service network-pre.target", "BlockIOAccounting": "no", "BlockIOWeight": "18446744073709551615", "BusName": "org.fedoraproject.FirewallD1", "CPUAccounting": "no", "CPUQuotaPerSecUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "18446744073709551615", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "18446744073709551615", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "Conflicts": "shutdown.target ebtables.service ip6tables.service iptables.service ipset.service", "ControlPID": "0", "DefaultDependencies": "yes", "Delegate": "no", "Description": "firewalld - dynamic firewall daemon", "DevicePolicy": "auto", "Documentation": "man:firewalld(1)", "EnvironmentFile": "/etc/sysconfig/firewalld (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/firewalld ; argv[]=/usr/sbin/firewalld --nofork --nopid $FIREWALLD_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/usr/lib/systemd/system/firewalld.service", "GuessMainPID": "yes", "IOScheduling": "0", "Id": "firewalld.service", "IgnoreOnIsolate": "no", "IgnoreOnSnapshot": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobTimeoutAction": "none", "JobTimeoutUSec": "0", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "18446744073709551615", "LimitCORE": "18446744073709551615", "LimitCPU": "18446744073709551615", "LimitDATA": "18446744073709551615", "LimitFSIZE": "18446744073709551615", "LimitLOCKS": "18446744073709551615", "LimitMEMLOCK": "65536", "LimitMSGQUEUE": "819200", "LimitNICE": "0", "LimitNOFILE": "4096", "LimitNPROC": "31119", "LimitRSS": "18446744073709551615", "LimitRTPRIO": "0", "LimitRTTIME": "18446744073709551615", "LimitSIGPENDING": "31119", "LimitSTACK": "18446744073709551615", "LoadState": "loaded", "MainPID": "0", "MemoryAccounting": "no", "MemoryCurrent": "18446744073709551615", "MemoryLimit": "18446744073709551615", "MountFlags": "0", "Names": "firewalld.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "PrivateDevices": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "ProtectHome": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "Requires": "system.slice basic.target", "Restart": "no", "RestartUSec": "100ms", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "null", "StandardInput": "null", "StandardOutput": "null", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitInterval": "10000000", "StartupBlockIOWeight": "18446744073709551615", "StartupCPUShares": "18446744073709551615", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "no", "TasksCurrent": "18446744073709551615", "TasksMax": "18446744073709551615", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "dbus", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "Wants": "network-pre.target", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
ok: [127.0.0.1] => (item=NetworkManager) => {"ansible_loop_var": "item", "changed": false, "enabled": false, "item": "NetworkManager", "name": "NetworkManager", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "systemd-journald.socket network-pre.target system.slice dbus.service basic.target", "AllowIsolate": "no", "AmbientCapabilities": "0", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "NetworkManager-wait-online.service network.service network.target shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "18446744073709551615", "BusName": "org.freedesktop.NetworkManager", "CPUAccounting": "no", "CPUQuotaPerSecUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "18446744073709551615", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "539309282", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "Conflicts": "shutdown.target", "ControlPID": "0", "DefaultDependencies": "yes", "Delegate": "no", "Description": "Network Manager", "DevicePolicy": "auto", "Documentation": "man:NetworkManager(8)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/usr/bin/dbus-send ; argv[]=/usr/bin/dbus-send --print-reply --system --type=method_call --dest=org.freedesktop.NetworkManager /org/freedesktop/NetworkManager org.freedesktop.NetworkManager.Reload uint32:0 ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/NetworkManager ; argv[]=/usr/sbin/NetworkManager --no-daemon ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/usr/lib/systemd/system/NetworkManager.service", "GuessMainPID": "yes", "IOScheduling": "0", "Id": "NetworkManager.service", "IgnoreOnIsolate": "no", "IgnoreOnSnapshot": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobTimeoutAction": "none", "JobTimeoutUSec": "0", "KillMode": "process", "KillSignal": "15", "LimitAS": "18446744073709551615", "LimitCORE": "18446744073709551615", "LimitCPU": "18446744073709551615", "LimitDATA": "18446744073709551615", "LimitFSIZE": "18446744073709551615", "LimitLOCKS": "18446744073709551615", "LimitMEMLOCK": "65536", "LimitMSGQUEUE": "819200", "LimitNICE": "0", "LimitNOFILE": "4096", "LimitNPROC": "31119", "LimitRSS": "18446744073709551615", "LimitRTPRIO": "0", "LimitRTTIME": "18446744073709551615", "LimitSIGPENDING": "31119", "LimitSTACK": "18446744073709551615", "LoadState": "loaded", "MainPID": "0", "MemoryAccounting": "no", "MemoryCurrent": "18446744073709551615", "MemoryLimit": "18446744073709551615", "MountFlags": "0", "Names": "NetworkManager.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "PrivateDevices": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "ProtectHome": "read-only", "ProtectSystem": "yes", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "RequiredBy": "NetworkManager-wait-online.service", "Requires": "system.slice basic.target", "Restart": "on-failure", "RestartUSec": "100ms", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitInterval": "10000000", "StartupBlockIOWeight": "18446744073709551615", "StartupCPUShares": "18446744073709551615", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "no", "TasksCurrent": "18446744073709551615", "TasksMax": "18446744073709551615", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "dbus", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "Wants": "network.target", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

TASK [common : Load br_netfilter] *****************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:66
ok: [127.0.0.1] => {"changed": false, "name": "br_netfilter", "params": "", "state": "present"}

TASK [common : Load br_netfilter at boot] *********************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:71
ok: [127.0.0.1] => {"changed": false, "checksum": "c3394aff3e3a3e3920e68205b8e839b3d725648e", "dest": "/etc/modules-load.d/kubernetes.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/modules-load.d/kubernetes.conf", "size": 12, "state": "file", "uid": 0}

TASK [common : Change sysctl setting] *************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:80
ok: [127.0.0.1] => (item=net.bridge.bridge-nf-call-iptables) => {"ansible_loop_var": "item", "changed": false, "item": "net.bridge.bridge-nf-call-iptables"}
ok: [127.0.0.1] => (item=net.bridge.bridge-nf-call-ip6tables) => {"ansible_loop_var": "item", "changed": false, "item": "net.bridge.bridge-nf-call-ip6tables"}
ok: [127.0.0.1] => (item=net.ipv4.ip_forward) => {"ansible_loop_var": "item", "changed": false, "item": "net.ipv4.ip_forward"}

TASK [common : Change sysctl fs.inotify.max_user_watches] *****************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:90
ok: [127.0.0.1] => {"changed": false}

TASK [common : Change sysctl fs.inotify.max_user_instances] ***************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:96
ok: [127.0.0.1] => {"changed": false}

TASK [common : Turn off swap mount] ***************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:103
ok: [127.0.0.1] => {"changed": false, "dump": "0", "fstab": "/etc/fstab", "fstype": "swap", "name": "swap", "opts": "defaults", "passno": "0"}

TASK [common : Turn off swap now] *****************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:108
skipping: [127.0.0.1] => {"changed": false, "skip_reason": "Conditional result was False"}

TASK [common : Config ipvs] ***********************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:112
ok: [127.0.0.1] => {"changed": false, "checksum": "6cd1b849237cd98710c45881e193b51928da107b", "dest": "/etc/sysconfig/modules/ipvs.modules", "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/sysconfig/modules/ipvs.modules", "size": 337, "state": "file", "uid": 0}

TASK [common : Load ipvs modules] *****************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:119
changed: [127.0.0.1] => {"changed": true, "cmd": "/etc/sysconfig/modules/ipvs.modules", "delta": "0:00:00.086708", "end": "2020-06-19 09:12:25.258452", "rc": 0, "start": "2020-06-19 09:12:25.171744", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [common : Add docker rpm repository] *********************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:125
ok: [127.0.0.1] => {"changed": false, "checksum_dest": "f5df3864590b9dcc53e2dc95bbbf0bacba2878bf", "checksum_src": "f5df3864590b9dcc53e2dc95bbbf0bacba2878bf", "dest": "/etc/yum.repos.d/docker-ce.repo", "elapsed": 0, "gid": 0, "group": "root", "md5sum": "494b8cf832d408308d9c356c523292ab", "mode": "0644", "msg": "OK (2640 bytes)", "owner": "root", "size": 2640, "src": "/root/.ansible/tmp/ansible-tmp-1592572345.49-55208-29542343234615/tmpEz4Z4A", "state": "file", "status_code": 200, "uid": 0, "url": "http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo"}

TASK [common : Install docker] ********************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:131
[DEPRECATION WARNING]: Invoking "yum" only once while using a loop via squash_actions is deprecated. Instead of using a loop to supply
 multiple items and specifying `name: "{{ item }}"`, please use `name: ['docker-ce-19.03.9', 'docker-ce-cli-19.03.9',
'containerd.io']` and remove the loop. This feature will be removed in version 2.11. Deprecation warnings can be disabled by setting
deprecation_warnings=False in ansible.cfg.
ok: [127.0.0.1] => (item=[u'docker-ce-19.03.9', u'docker-ce-cli-19.03.9', u'containerd.io']) => {"ansible_loop_var": "item", "changed": false, "item": ["docker-ce-19.03.9", "docker-ce-cli-19.03.9", "containerd.io"], "msg": "", "rc": 0, "results": ["3:docker-ce-19.03.9-3.el7.x86_64 providing docker-ce-19.03.9 is already installed", "1:docker-ce-cli-19.03.9-3.el7.x86_64 providing docker-ce-cli-19.03.9 is already installed", "containerd.io-1.2.13-3.2.el7.x86_64 providing containerd.io is already installed"]}

TASK [common : Make /etc/docker dir] **************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:138
[WARNING]: Consider using the file module with state=directory rather than running 'mkdir'.  If you need to use command because file
is insufficient you can add 'warn: false' to this command task or set 'command_warnings=False' in ansible.cfg to get rid of this
message.
changed: [127.0.0.1] => {"changed": true, "cmd": "mkdir -p /etc/docker", "delta": "0:00:00.010111", "end": "2020-06-19 09:12:27.301673", "rc": 0, "start": "2020-06-19 09:12:27.291562", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [common : Config docker file] ****************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:141
ok: [127.0.0.1] => {"changed": false, "checksum": "764b1b752176a0b8432bc31283b18af42499601a", "dest": "/etc/docker/daemon.json", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/docker/daemon.json", "size": 337, "state": "file", "uid": 0}

TASK [common : Restart docker service] ************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:144
changed: [127.0.0.1] => {"changed": true, "enabled": true, "name": "docker", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2020-06-19 09:09:12 EDT", "ActiveEnterTimestampMonotonic": "10481250914", "ActiveExitTimestamp": "Fri 2020-06-19 09:09:12 EDT", "ActiveExitTimestampMonotonic": "10480910143", "ActiveState": "active", "After": "docker.socket firewalld.service basic.target system.slice containerd.service systemd-journald.socket network-online.target", "AllowIsolate": "no", "AmbientCapabilities": "0", "AssertResult": "yes", "AssertTimestamp": "Fri 2020-06-19 09:09:12 EDT", "AssertTimestampMonotonic": "10480929019", "Before": "shutdown.target multi-user.target", "BindsTo": "containerd.service", "BlockIOAccounting": "no", "BlockIOWeight": "18446744073709551615", "CPUAccounting": "no", "CPUQuotaPerSecUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "18446744073709551615", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "18446744073709551615", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2020-06-19 09:09:12 EDT", "ConditionTimestampMonotonic": "10480929019", "Conflicts": "shutdown.target", "ConsistsOf": "docker.socket", "ControlGroup": "/system.slice/docker.service", "ControlPID": "0", "DefaultDependencies": "yes", "Delegate": "yes", "Description": "Docker Application Container Engine", "DevicePolicy": "auto", "Documentation": "https://docs.docker.com", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "49020", "ExecMainStartTimestamp": "Fri 2020-06-19 09:09:12 EDT", "ExecMainStartTimestampMonotonic": "10480940693", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/usr/lib/systemd/system/docker.service", "GuessMainPID": "yes", "IOScheduling": "0", "Id": "docker.service", "IgnoreOnIsolate": "no", "IgnoreOnSnapshot": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2020-06-19 09:09:12 EDT", "InactiveEnterTimestampMonotonic": "10480920291", "InactiveExitTimestamp": "Fri 2020-06-19 09:09:12 EDT", "InactiveExitTimestampMonotonic": "10480940781", "JobTimeoutAction": "none", "JobTimeoutUSec": "0", "KillMode": "process", "KillSignal": "15", "LimitAS": "18446744073709551615", "LimitCORE": "18446744073709551615", "LimitCPU": "18446744073709551615", "LimitDATA": "18446744073709551615", "LimitFSIZE": "18446744073709551615", "LimitLOCKS": "18446744073709551615", "LimitMEMLOCK": "65536", "LimitMSGQUEUE": "819200", "LimitNICE": "0", "LimitNOFILE": "18446744073709551615", "LimitNPROC": "18446744073709551615", "LimitRSS": "18446744073709551615", "LimitRTPRIO": "0", "LimitRTTIME": "18446744073709551615", "LimitSIGPENDING": "31119", "LimitSTACK": "18446744073709551615", "LoadState": "loaded", "MainPID": "49020", "MemoryAccounting": "no", "MemoryCurrent": "18446744073709551615", "MemoryLimit": "18446744073709551615", "MountFlags": "0", "Names": "docker.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "PrivateDevices": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "ProtectHome": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "Requires": "basic.target docker.socket system.slice", "Restart": "always", "RestartUSec": "2s", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "3", "StartLimitInterval": "60000000", "StartupBlockIOWeight": "18446744073709551615", "StartupCPUShares": "18446744073709551615", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "no", "TasksCurrent": "18446744073709551615", "TasksMax": "18446744073709551615", "TimeoutStartUSec": "0", "TimeoutStopUSec": "0", "TimerSlackNSec": "50000", "Transient": "no", "TriggeredBy": "docker.socket", "Type": "notify", "UMask": "0022", "UnitFilePreset": "disabled", "UnitFileState": "enabled", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogTimestamp": "Fri 2020-06-19 09:09:12 EDT", "WatchdogTimestampMonotonic": "10481250856", "WatchdogUSec": "0"}}

TASK [common : Add kubernetes rpm repository] *****************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:150
ok: [127.0.0.1] => {"changed": false, "checksum": "2547dde5142d0fc2e1e245df8ad221b5b0cfc34e", "dest": "/etc/yum.repos.d/kubernetes.repo", "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/yum.repos.d/kubernetes.repo", "size": 272, "state": "file", "uid": 0}

TASK [common : Install k8s packages] **************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:158
[DEPRECATION WARNING]: Invoking "yum" only once while using a loop via squash_actions is deprecated. Instead of using a loop to supply
 multiple items and specifying `name: "{{ item }}"`, please use `name: ['bridge-utils', 'ipvsadm', 'conntrack-tools', 'jq',
'kubelet-1.15.8-0', 'kubectl-1.15.8-0', 'kubeadm-1.15.8-0']` and remove the loop. This feature will be removed in version 2.11.
Deprecation warnings can be disabled by setting deprecation_warnings=False in ansible.cfg.
ok: [127.0.0.1] => (item=[u'bridge-utils', u'ipvsadm', u'conntrack-tools', u'jq', u'kubelet-1.15.8-0', u'kubectl-1.15.8-0', u'kubeadm-1.15.8-0']) => {"ansible_loop_var": "item", "changed": false, "item": ["bridge-utils", "ipvsadm", "conntrack-tools", "jq", "kubelet-1.15.8-0", "kubectl-1.15.8-0", "kubeadm-1.15.8-0"], "msg": "", "rc": 0, "results": ["bridge-utils-1.5-9.el7.x86_64 providing bridge-utils is already installed", "ipvsadm-1.27-8.el7.x86_64 providing ipvsadm is already installed", "conntrack-tools-1.4.4-7.el7.x86_64 providing conntrack-tools is already installed", "jq-1.6-1.el7.x86_64 providing jq is already installed", "kubelet-1.15.8-0.x86_64 providing kubelet-1.15.8-0 is already installed", "kubectl-1.15.8-0.x86_64 providing kubectl-1.15.8-0 is already installed", "kubeadm-1.15.8-0.x86_64 providing kubeadm-1.15.8-0 is already installed"]}

TASK [common : Enable kubelet] ********************************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:170
ok: [127.0.0.1] => {"changed": false, "enabled": true, "name": "kubelet", "status": {"ActiveEnterTimestamp": "Fri 2020-06-19 09:09:56 EDT", "ActiveEnterTimestampMonotonic": "10525198841", "ActiveExitTimestamp": "Fri 2020-06-19 09:11:16 EDT", "ActiveExitTimestampMonotonic": "10605261077", "ActiveState": "inactive", "After": "basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AmbientCapabilities": "0", "AssertResult": "yes", "AssertTimestamp": "Fri 2020-06-19 09:09:56 EDT", "AssertTimestampMonotonic": "10525190197", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "18446744073709551615", "CPUAccounting": "no", "CPUQuotaPerSecUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "18446744073709551615", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "18446744073709551615", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2020-06-19 09:09:56 EDT", "ConditionTimestampMonotonic": "10525190197", "Conflicts": "shutdown.target", "ControlPID": "0", "DefaultDependencies": "yes", "Delegate": "no", "Description": "kubelet: The Kubernetes Node Agent", "DevicePolicy": "auto", "Documentation": "https://kubernetes.io/docs/", "DropInPaths": "/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf", "Environment": "KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml", "EnvironmentFile": "/etc/sysconfig/kubelet (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Fri 2020-06-19 09:11:16 EDT", "ExecMainExitTimestampMonotonic": "10605269793", "ExecMainPID": "49741", "ExecMainStartTimestamp": "Fri 2020-06-19 09:09:56 EDT", "ExecMainStartTimestampMonotonic": "10525198693", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/kubelet ; argv[]=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/usr/lib/systemd/system/kubelet.service", "GuessMainPID": "yes", "IOScheduling": "0", "Id": "kubelet.service", "IgnoreOnIsolate": "no", "IgnoreOnSnapshot": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2020-06-19 09:11:16 EDT", "InactiveEnterTimestampMonotonic": "10605270045", "InactiveExitTimestamp": "Fri 2020-06-19 09:09:56 EDT", "InactiveExitTimestampMonotonic": "10525198841", "JobTimeoutAction": "none", "JobTimeoutUSec": "0", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "18446744073709551615", "LimitCORE": "18446744073709551615", "LimitCPU": "18446744073709551615", "LimitDATA": "18446744073709551615", "LimitFSIZE": "18446744073709551615", "LimitLOCKS": "18446744073709551615", "LimitMEMLOCK": "65536", "LimitMSGQUEUE": "819200", "LimitNICE": "0", "LimitNOFILE": "4096", "LimitNPROC": "31119", "LimitRSS": "18446744073709551615", "LimitRTPRIO": "0", "LimitRTTIME": "18446744073709551615", "LimitSIGPENDING": "31119", "LimitSTACK": "18446744073709551615", "LoadState": "loaded", "MainPID": "0", "MemoryAccounting": "no", "MemoryCurrent": "18446744073709551615", "MemoryLimit": "18446744073709551615", "MountFlags": "0", "Names": "kubelet.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "PrivateDevices": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "ProtectHome": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "Requires": "basic.target system.slice", "Restart": "always", "RestartUSec": "10s", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitInterval": "0", "StartupBlockIOWeight": "18446744073709551615", "StartupCPUShares": "18446744073709551615", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "no", "TasksCurrent": "18446744073709551615", "TasksMax": "18446744073709551615", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UMask": "0022", "UnitFilePreset": "disabled", "UnitFileState": "enabled", "WantedBy": "multi-user.target", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}

TASK [common : Export yunion bin path in /etc/profile] ********************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:174
ok: [127.0.0.1] => {"backup": "", "changed": false, "msg": ""}

TASK [common : Enable yunion systemd services] ****************************************************************************************
task path: /root/ocboot/onecloud/roles/common/tasks/main.yml:183
ok: [127.0.0.1] => (item=yunion-executor) => {"ansible_loop_var": "item", "changed": false, "enabled": true, "item": "yunion-executor", "name": "yunion-executor", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2020-06-19 04:14:40 EDT", "ActiveEnterTimestampMonotonic": "6497667", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "basic.target -.mount system.slice systemd-journald.socket", "AllowIsolate": "no", "AmbientCapabilities": "0", "AssertResult": "yes", "AssertTimestamp": "Fri 2020-06-19 04:14:40 EDT", "AssertTimestampMonotonic": "6472564", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "18446744073709551615", "CPUAccounting": "no", "CPUQuotaPerSecUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "18446744073709551615", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "18446744073709551615", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2020-06-19 04:14:40 EDT", "ConditionTimestampMonotonic": "6472564", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/yunion-executor.service", "ControlPID": "0", "DefaultDependencies": "yes", "Delegate": "no", "Description": "Yunion Command Executor", "DevicePolicy": "auto", "Documentation": "https://docs.yunion.cn", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "745", "ExecMainStartTimestamp": "Fri 2020-06-19 04:14:40 EDT", "ExecMainStartTimestampMonotonic": "6497314", "ExecMainStatus": "0", "ExecStart": "{ path=/opt/yunion/bin/executor-server ; argv[]=/opt/yunion/bin/executor-server ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FragmentPath": "/usr/lib/systemd/system/yunion-executor.service", "Group": "root", "GuessMainPID": "yes", "IOScheduling": "0", "Id": "yunion-executor.service", "IgnoreOnIsolate": "no", "IgnoreOnSnapshot": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Fri 2020-06-19 04:14:40 EDT", "InactiveExitTimestampMonotonic": "6497667", "JobTimeoutAction": "none", "JobTimeoutUSec": "0", "KillMode": "process", "KillSignal": "15", "LimitAS": "18446744073709551615", "LimitCORE": "18446744073709551615", "LimitCPU": "18446744073709551615", "LimitDATA": "18446744073709551615", "LimitFSIZE": "18446744073709551615", "LimitLOCKS": "18446744073709551615", "LimitMEMLOCK": "65536", "LimitMSGQUEUE": "819200", "LimitNICE": "0", "LimitNOFILE": "500000", "LimitNPROC": "500000", "LimitRSS": "18446744073709551615", "LimitRTPRIO": "0", "LimitRTTIME": "18446744073709551615", "LimitSIGPENDING": "31119", "LimitSTACK": "18446744073709551615", "LoadState": "loaded", "MainPID": "745", "MemoryAccounting": "no", "MemoryCurrent": "21422080", "MemoryLimit": "18446744073709551615", "MountFlags": "0", "Names": "yunion-executor.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "PermissionsStartOnly": "no", "PrivateDevices": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "ProtectHome": "no", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "RemainAfterExit": "no", "Requires": "basic.target -.mount system.slice", "RequiresMountsFor": "/opt/yunion/bin", "Restart": "always", "RestartUSec": "30s", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitInterval": "10000000", "StartupBlockIOWeight": "18446744073709551615", "StartupCPUShares": "18446744073709551615", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "0", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "no", "TasksCurrent": "6", "TasksMax": "18446744073709551615", "TimeoutStartUSec": "1min 30s", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UMask": "0022", "UnitFilePreset": "disabled", "UnitFileState": "enabled", "User": "root", "WantedBy": "multi-user.target", "WatchdogTimestamp": "Fri 2020-06-19 04:14:40 EDT", "WatchdogTimestampMonotonic": "6497589", "WatchdogUSec": "0", "WorkingDirectory": "/opt/yunion/bin"}}

TASK [primary-master-node : Get default gateway] **************************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:5
changed: [127.0.0.1] => {"changed": true, "cmd": "ip route get 1 | head -n 1 | awk '{print $3}'", "delta": "0:00:00.009565", "end": "2020-06-19 09:12:33.110610", "rc": 0, "start": "2020-06-19 09:12:33.101045", "stderr": "", "stderr_lines": [], "stdout": "192.168.137.2", "stdout_lines": ["192.168.137.2"]}

TASK [primary-master-node : set default gateway var] **********************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:9
ok: [127.0.0.1] => {"ansible_facts": {"default_gateway": "192.168.137.2"}, "changed": false}

TASK [primary-master-node : Get default gateway 192.168.137.2 local ip address] *******************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:13
changed: [127.0.0.1] => {"changed": true, "cmd": "ip route get 1 | head -n 1 | awk '{print $7}'", "delta": "0:00:00.008940", "end": "2020-06-19 09:12:33.673240", "rc": 0, "start": "2020-06-19 09:12:33.664300", "stderr": "", "stderr_lines": [], "stdout": "192.168.137.190", "stdout_lines": ["192.168.137.190"]}

TASK [primary-master-node : set default ip var] ***************************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:17
ok: [127.0.0.1] => {"ansible_facts": {"default_ip": "192.168.137.190"}, "changed": false}

TASK [primary-master-node : Get default ip address 192.168.137.190 masklen] ***********************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:21
changed: [127.0.0.1] => {"changed": true, "cmd": "ip route list | grep 192.168.137.190 | head -n 1 | awk '{print $1}' | cut -d '/' -f 2", "delta": "0:00:00.011152", "end": "2020-06-19 09:12:34.263700", "rc": 0, "start": "2020-06-19 09:12:34.252548", "stderr": "", "stderr_lines": [], "stdout": "24", "stdout_lines": ["24"]}

TASK [primary-master-node : set default ip masklen] ***********************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:25
ok: [127.0.0.1] => {"ansible_facts": {"default_masklen": "24"}, "changed": false}

TASK [primary-master-node : Get cluster token] ****************************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:29
changed: [127.0.0.1] => {"changed": true, "cmd": "/opt/yunion/bin/ocadm token list | cut -d  ' ' -f1 | sed -n '2p'", "delta": "0:00:00.137109", "end": "2020-06-19 09:12:34.818033", "rc": 0, "start": "2020-06-19 09:12:34.680924", "stderr": "failed to load admin kubeconfig: open /etc/kubernetes/admin.conf: no such file or directory", "stderr_lines": ["failed to load admin kubeconfig: open /etc/kubernetes/admin.conf: no such file or directory"], "stdout": "", "stdout_lines": []}

TASK [primary-master-node : Pull ocadm images on node] ********************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:33
changed: [127.0.0.1] => {"changed": true, "cmd": ["/opt/yunion/bin/ocadm", "config", "images", "pull", "--image-repository", "registry.cn-beijing.aliyuncs.com/yunionio"], "delta": "0:00:17.093107", "end": "2020-06-19 09:12:52.289511", "rc": 0, "start": "2020-06-19 09:12:35.196404", "stderr": "", "stderr_lines": [], "stdout": "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-apiserver:v1.15.8\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-apiserver:v1.15.8\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-controller-manager:v1.15.8\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-controller-manager:v1.15.8\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-scheduler:v1.15.8\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-scheduler:v1.15.8\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-proxy:v1.15.8\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-proxy:v1.15.8\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/pause:3.1\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/pause:3.1\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/etcd:3.3.10\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/etcd:3.3.10\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/coredns:1.3.1\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/coredns:1.3.1\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/calico-kube-controllers:v3.7.2\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/calico-kube-controllers:v3.7.2\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/calico-node:v3.7.2\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/calico-node:v3.7.2\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/calico-cni:v3.7.2\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/calico-cni:v3.7.2\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/local-path-provisioner:v0.0.11\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/local-path-provisioner:v0.0.11\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/traefik:v1.7\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/traefik:v1.7\n[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/onecloud-operator:v3.1.9-20200609.1\n[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/onecloud-operator:v3.1.9-20200609.1", "stdout_lines": ["[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-apiserver:v1.15.8", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-apiserver:v1.15.8", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-controller-manager:v1.15.8", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-controller-manager:v1.15.8", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-scheduler:v1.15.8", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-scheduler:v1.15.8", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/kube-proxy:v1.15.8", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/kube-proxy:v1.15.8", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/pause:3.1", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/pause:3.1", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/etcd:3.3.10", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/etcd:3.3.10", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/coredns:1.3.1", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/coredns:1.3.1", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/calico-kube-controllers:v3.7.2", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/calico-kube-controllers:v3.7.2", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/calico-node:v3.7.2", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/calico-node:v3.7.2", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/calico-cni:v3.7.2", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/calico-cni:v3.7.2", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/local-path-provisioner:v0.0.11", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/local-path-provisioner:v0.0.11", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/traefik:v1.7", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/traefik:v1.7", "[config/images] Pulling registry.cn-beijing.aliyuncs.com/yunionio/onecloud-operator:v3.1.9-20200609.1", "[config/images] Pulled registry.cn-beijing.aliyuncs.com/yunionio/onecloud-operator:v3.1.9-20200609.1"]}

TASK [primary-master-node : Check node is init] ***************************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:39
ok: [127.0.0.1] => {"changed": false, "cmd": "test -f /etc/kubernetes/kubelet.conf", "delta": "0:00:00.005267", "end": "2020-06-19 09:12:52.666920", "failed_when_result": false, "msg": "non-zero return code", "rc": 1, "start": "2020-06-19 09:12:52.661653", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [primary-master-node : construct controlplane endpoint] **************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:47
ok: [127.0.0.1] => {"ansible_facts": {"controlplane_endpoint": "192.168.137.190:6443"}, "changed": false}

TASK [primary-master-node : construct init args] **************************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:51
ok: [127.0.0.1] => {"ansible_facts": {"init_args": "init --mysql-host 192.168.137.190 --mysql-user root --mysql-password qwe123 --control-plane-endpoint 192.168.137.190:6443"}, "changed": false}

TASK [primary-master-node : construct image repository] *******************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:55
skipping: [127.0.0.1] => {"changed": false, "skip_reason": "Conditional result was False"}

TASK [primary-master-node : construct onecloud version] *******************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:61
skipping: [127.0.0.1] => {"changed": false, "skip_reason": "Conditional result was False"}

TASK [primary-master-node : init node as onecloud host agent] *************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:67
ok: [127.0.0.1] => {"ansible_facts": {"init_args": "init --mysql-host 192.168.137.190 --mysql-user root --mysql-password qwe123 --control-plane-endpoint 192.168.137.190:6443 --enable-host-agent"}, "changed": false}

TASK [primary-master-node : Use ocadm init first master node] *************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:73
changed: [127.0.0.1] => {"changed": true, "cmd": ["/opt/yunion/bin/ocadm", "init", "--mysql-host", "192.168.137.190", "--mysql-user", "root", "--mysql-password", "qwe123", "--control-plane-endpoint", "192.168.137.190:6443", "--enable-host-agent"], "delta": "0:00:29.169449", "end": "2020-06-19 09:13:22.805060", "rc": 0, "start": "2020-06-19 09:12:53.635611", "stderr": "\t[WARNING SystemVerification]: this Docker version is not on the list of validated versions: 19.03.9. Latest validated version: 18.09\nI0619 09:13:22.772341   55811 addons.go:60] [enable-host] Enable host for node localhost.localdomain", "stderr_lines": ["\t[WARNING SystemVerification]: this Docker version is not on the list of validated versions: 19.03.9. Latest validated version: 18.09", "I0619 09:13:22.772341   55811 addons.go:60] [enable-host] Enable host for node localhost.localdomain"], "stdout": "[init] Using Kubernetes and Onecloud version: v1.15.8 & v3.1.9-20200609.1\n[preflight] Running pre-flight checks\n[preflight] Pulling images required for setting up a OneCloud on Kubernetes cluster\n[preflight] This might take a minute or two, depending on the speed of your internet connection\n[preflight] You can also perform this action in beforehand using 'ocadm config images pull'\n[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"\n[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"\n[kubelet-start] Activating the kubelet service\n[certs] Using certificateDir folder \"/etc/kubernetes/pki\"\n[certs] Generating \"ca\" certificate and key\n[certs] Generating \"apiserver\" certificate and key\n[certs] apiserver serving cert is signed for DNS names [localhost.localdomain kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 192.168.137.190 192.168.137.190]\n[certs] Generating \"apiserver-kubelet-client\" certificate and key\n[certs] Generating \"front-proxy-ca\" certificate and key\n[certs] Generating \"front-proxy-client\" certificate and key\n[certs] Generating \"etcd/ca\" certificate and key\n[certs] Generating \"apiserver-etcd-client\" certificate and key\n[certs] Generating \"etcd/server\" certificate and key\n[certs] etcd/server serving cert is signed for DNS names [localhost.localdomain localhost] and IPs [192.168.137.190 127.0.0.1 ::1]\n[certs] Generating \"etcd/peer\" certificate and key\n[certs] etcd/peer serving cert is signed for DNS names [localhost.localdomain localhost] and IPs [192.168.137.190 127.0.0.1 ::1]\n[certs] Generating \"etcd/healthcheck-client\" certificate and key\n[certs] Generating \"sa\" key and public key\n[kubeconfig] Using kubeconfig folder \"/etc/kubernetes\"\n[kubeconfig] Writing \"admin.conf\" kubeconfig file\n[kubeconfig] Writing \"kubelet.conf\" kubeconfig file\n[kubeconfig] Writing \"controller-manager.conf\" kubeconfig file\n[kubeconfig] Writing \"scheduler.conf\" kubeconfig file\n[control-plane] Using manifest folder \"/etc/kubernetes/manifests\"\n[control-plane] Creating static Pod manifest for \"kube-apiserver\"\n[control-plane] Creating static Pod manifest for \"kube-controller-manager\"\n[control-plane] Creating static Pod manifest for \"kube-scheduler\"\n[etcd] Creating static Pod manifest for local etcd in \"/etc/kubernetes/manifests\"\n[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \"/etc/kubernetes/manifests\". This can take up to 4m0s\n[apiclient] All control plane components are healthy after 16.004632 seconds\n[upload-config] Storing the configuration used in ConfigMap \"kubeadm-config\" in the \"kube-system\" Namespace\n[kubelet] Creating a ConfigMap \"kubelet-config-1.15\" in namespace kube-system with the configuration for the kubelets in the cluster\n[upload-certs] Storing the certificates in Secret \"kubeadm-certs\" in the \"kube-system\" Namespace\n[upload-certs] Using certificate key:\n70775d2d9aa973c41daf09d14610e75af2e46865adb77ced17e1be7d20269839\n[mark-control-plane] Marking the node localhost.localdomain as control-plane by adding the label \"node-role.kubernetes.io/master=''\"\n[mark-control-plane] Marking the node localhost.localdomain as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]\n[bootstrap-token] Using token: 36mkjj.zf2i3ppe5szzp6q2\n[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles\n[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials\n[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token\n[bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster\n[bootstrap-token] Creating the \"cluster-info\" ConfigMap in the \"kube-public\" namespace\n[oc-upload-config] storing the configuration used in ConfigMap \"ocadm-config\" in the \"kube-system\" Namespace\n[addons] Applied essential addon: CoreDNS\n[addons] Applied essential addon: kube-proxy\n[oc-addons] Applied addon: calico\n[oc-addons] Applied addon: local-path-provisioner\n[oc-addons] Applied addon: traefik\n[oc-addons] Applied addon: onecloud-operator\n\nYour Kubernetes and Onecloud control-plane has initialized successfully!\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  mkdir -p $HOME/.kube\n  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\n  sudo chown $(id -u):$(id -g) $HOME/.kube/config\n\nYou can now join any number of the control-plane node running the following command on each as root:\n\n  ocadm join 192.168.137.190:6443 --token 36mkjj.zf2i3ppe5szzp6q2 \\\n    --discovery-token-ca-cert-hash sha256:32fe2be8fa02f1a435fca186e9b48419e842e40c21db42cdba45f8508a63062e \\\n    --control-plane --certificate-key 70775d2d9aa973c41daf09d14610e75af2e46865adb77ced17e1be7d20269839\n\nPlease note that the certificate-key gives access to cluster sensitive data, keep it secret!\nAs a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use\n\"ocadm init phase upload-certs --experimental-upload-certs\" to reload certs afterward.\n\nThen you can join any number of worker nodes by running the following on each as root:\n\nocadm join 192.168.137.190:6443 --token 36mkjj.zf2i3ppe5szzp6q2 \\\n    --discovery-token-ca-cert-hash sha256:32fe2be8fa02f1a435fca186e9b48419e842e40c21db42cdba45f8508a63062e ", "stdout_lines": ["[init] Using Kubernetes and Onecloud version: v1.15.8 & v3.1.9-20200609.1", "[preflight] Running pre-flight checks", "[preflight] Pulling images required for setting up a OneCloud on Kubernetes cluster", "[preflight] This might take a minute or two, depending on the speed of your internet connection", "[preflight] You can also perform this action in beforehand using 'ocadm config images pull'", "[kubelet-start] Writing kubelet environment file with flags to file \"/var/lib/kubelet/kubeadm-flags.env\"", "[kubelet-start] Writing kubelet configuration to file \"/var/lib/kubelet/config.yaml\"", "[kubelet-start] Activating the kubelet service", "[certs] Using certificateDir folder \"/etc/kubernetes/pki\"", "[certs] Generating \"ca\" certificate and key", "[certs] Generating \"apiserver\" certificate and key", "[certs] apiserver serving cert is signed for DNS names [localhost.localdomain kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 192.168.137.190 192.168.137.190]", "[certs] Generating \"apiserver-kubelet-client\" certificate and key", "[certs] Generating \"front-proxy-ca\" certificate and key", "[certs] Generating \"front-proxy-client\" certificate and key", "[certs] Generating \"etcd/ca\" certificate and key", "[certs] Generating \"apiserver-etcd-client\" certificate and key", "[certs] Generating \"etcd/server\" certificate and key", "[certs] etcd/server serving cert is signed for DNS names [localhost.localdomain localhost] and IPs [192.168.137.190 127.0.0.1 ::1]", "[certs] Generating \"etcd/peer\" certificate and key", "[certs] etcd/peer serving cert is signed for DNS names [localhost.localdomain localhost] and IPs [192.168.137.190 127.0.0.1 ::1]", "[certs] Generating \"etcd/healthcheck-client\" certificate and key", "[certs] Generating \"sa\" key and public key", "[kubeconfig] Using kubeconfig folder \"/etc/kubernetes\"", "[kubeconfig] Writing \"admin.conf\" kubeconfig file", "[kubeconfig] Writing \"kubelet.conf\" kubeconfig file", "[kubeconfig] Writing \"controller-manager.conf\" kubeconfig file", "[kubeconfig] Writing \"scheduler.conf\" kubeconfig file", "[control-plane] Using manifest folder \"/etc/kubernetes/manifests\"", "[control-plane] Creating static Pod manifest for \"kube-apiserver\"", "[control-plane] Creating static Pod manifest for \"kube-controller-manager\"", "[control-plane] Creating static Pod manifest for \"kube-scheduler\"", "[etcd] Creating static Pod manifest for local etcd in \"/etc/kubernetes/manifests\"", "[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \"/etc/kubernetes/manifests\". This can take up to 4m0s", "[apiclient] All control plane components are healthy after 16.004632 seconds", "[upload-config] Storing the configuration used in ConfigMap \"kubeadm-config\" in the \"kube-system\" Namespace", "[kubelet] Creating a ConfigMap \"kubelet-config-1.15\" in namespace kube-system with the configuration for the kubelets in the cluster", "[upload-certs] Storing the certificates in Secret \"kubeadm-certs\" in the \"kube-system\" Namespace", "[upload-certs] Using certificate key:", "70775d2d9aa973c41daf09d14610e75af2e46865adb77ced17e1be7d20269839", "[mark-control-plane] Marking the node localhost.localdomain as control-plane by adding the label \"node-role.kubernetes.io/master=''\"", "[mark-control-plane] Marking the node localhost.localdomain as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]", "[bootstrap-token] Using token: 36mkjj.zf2i3ppe5szzp6q2", "[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles", "[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials", "[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token", "[bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster", "[bootstrap-token] Creating the \"cluster-info\" ConfigMap in the \"kube-public\" namespace", "[oc-upload-config] storing the configuration used in ConfigMap \"ocadm-config\" in the \"kube-system\" Namespace", "[addons] Applied essential addon: CoreDNS", "[addons] Applied essential addon: kube-proxy", "[oc-addons] Applied addon: calico", "[oc-addons] Applied addon: local-path-provisioner", "[oc-addons] Applied addon: traefik", "[oc-addons] Applied addon: onecloud-operator", "", "Your Kubernetes and Onecloud control-plane has initialized successfully!", "", "To start using your cluster, you need to run the following as a regular user:", "", "  mkdir -p $HOME/.kube", "  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config", "  sudo chown $(id -u):$(id -g) $HOME/.kube/config", "", "You can now join any number of the control-plane node running the following command on each as root:", "", "  ocadm join 192.168.137.190:6443 --token 36mkjj.zf2i3ppe5szzp6q2 \\", "    --discovery-token-ca-cert-hash sha256:32fe2be8fa02f1a435fca186e9b48419e842e40c21db42cdba45f8508a63062e \\", "    --control-plane --certificate-key 70775d2d9aa973c41daf09d14610e75af2e46865adb77ced17e1be7d20269839", "", "Please note that the certificate-key gives access to cluster sensitive data, keep it secret!", "As a safeguard, uploaded-certs will be deleted in two hours; If necessary, you can use", "\"ocadm init phase upload-certs --experimental-upload-certs\" to reload certs afterward.", "", "Then you can join any number of worker nodes by running the following on each as root:", "", "ocadm join 192.168.137.190:6443 --token 36mkjj.zf2i3ppe5szzp6q2 \\", "    --discovery-token-ca-cert-hash sha256:32fe2be8fa02f1a435fca186e9b48419e842e40c21db42cdba45f8508a63062e "]}

TASK [primary-master-node : Wait 500 seconds for primary master to response: 192.168.137.190:6443] ************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:77
ok: [127.0.0.1] => {"changed": false, "elapsed": 1, "match_groupdict": {}, "match_groups": [], "path": null, "port": 6443, "search_regex": null, "state": "started"}

TASK [primary-master-node : Export KUBECONFIG in master's ~/.bashrc] ******************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:85
ok: [127.0.0.1] => {"backup": "", "changed": false, "msg": ""}

TASK [primary-master-node : Source kubectl bash completion in master' /etc/profile] ***************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:94
ok: [127.0.0.1] => {"backup": "", "changed": false, "msg": ""}

TASK [primary-master-node : Wait onecloud CRD created] ********************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:103
FAILED - RETRYING: Wait onecloud CRD created (30 retries left).
FAILED - RETRYING: Wait onecloud CRD created (29 retries left).
changed: [127.0.0.1] => {"attempts": 3, "changed": true, "cmd": "kubectl get crd | grep onecloudcluster", "delta": "0:00:00.307379", "end": "2020-06-19 09:13:47.494261", "rc": 0, "start": "2020-06-19 09:13:47.186882", "stderr": "", "stderr_lines": [], "stdout": "onecloudclusters.onecloud.yunion.io           2020-06-19T13:13:47Z", "stdout_lines": ["onecloudclusters.onecloud.yunion.io           2020-06-19T13:13:47Z"]}

TASK [primary-master-node : Check onecloud cluster exists] ****************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:112
changed: [127.0.0.1] => {"changed": true, "cmd": "kubectl get onecloudcluster -n onecloud | grep default | wc -l", "delta": "0:00:00.390113", "end": "2020-06-19 09:13:48.313265", "rc": 0, "start": "2020-06-19 09:13:47.923152", "stderr": "No resources found.", "stderr_lines": ["No resources found."], "stdout": "0", "stdout_lines": ["0"]}

TASK [primary-master-node : Create essential services, wait for a few minutes...] *****************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:118



changed: [127.0.0.1] => {"attempts": 1, "changed": true, "cmd": "/opt/yunion/bin/ocadm cluster create --wait", "delta": "0:10:40.163163", "end": "2020-06-19 09:24:28.987060", "rc": 0, "start": "2020-06-19 09:13:48.823897", "stderr": "[I 200619 09:13:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: keystone: current status is nil, maybe deployment not created\n[I 200619 09:13:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: keystone: keystone is upgrading\n[I 200619 09:14:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: keystone: keystone is upgrading\n[I 200619 09:14:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created\n[I 200619 09:14:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created\n[I 200619 09:14:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created\n[I 200619 09:14:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created\n[I 200619 09:14:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:15:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:15:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:15:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:15:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:15:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:15:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:16:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:16:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:16:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:16:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:16:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:16:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:17:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:17:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:17:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:17:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:17:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:17:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:18:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:18:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:18:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:18:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:18:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:18:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:19:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:19:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:19:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:19:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:19:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:19:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:20:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:20:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:20:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:20:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:20:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:20:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:21:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:21:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:21:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:21:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:21:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:21:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:22:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:22:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:22:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:22:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:22:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:22:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:23:08 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:23:18 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:23:28 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:23:38 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:23:48 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:23:58 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:24:08 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading\n[I 200619 09:24:18 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "stderr_lines": ["[I 200619 09:13:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: keystone: current status is nil, maybe deployment not created", "[I 200619 09:13:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: keystone: keystone is upgrading", "[I 200619 09:14:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: keystone: keystone is upgrading", "[I 200619 09:14:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created", "[I 200619 09:14:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created", "[I 200619 09:14:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created", "[I 200619 09:14:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: current status is nil, maybe deployment not created", "[I 200619 09:14:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:15:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:15:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:15:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:15:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:15:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:15:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:16:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:16:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:16:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:16:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:16:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:16:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:17:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:17:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:17:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:17:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:17:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:17:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:18:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:18:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:18:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:18:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:18:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:18:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:19:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:19:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:19:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:19:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:19:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:19:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:20:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:20:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:20:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:20:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:20:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:20:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:21:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:21:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:21:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:21:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:21:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:21:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:22:09 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:22:19 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:22:29 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:22:39 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:22:49 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:22:59 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:23:08 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:23:18 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:23:28 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:23:38 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:23:48 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:23:58 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:24:08 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading", "[I 200619 09:24:18 onecloud.WaitOnecloudDeploymentUpdated.func1(operator.go:155)] Wait: glance: glance is upgrading"], "stdout": "Cluster default created", "stdout_lines": ["Cluster default created"]}

TASK [primary-master-node : Check onecloud user demo exists] **************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:126
changed: [127.0.0.1] => {"changed": true, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc user-list | grep -w demo | wc -l\n", "delta": "0:00:01.393779", "end": "2020-06-19 09:24:31.007207", "rc": 0, "start": "2020-06-19 09:24:29.613428", "stderr": "", "stderr_lines": [], "stdout": "0", "stdout_lines": ["0"]}

TASK [primary-master-node : Create onecloud web login user demo] **********************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:132
changed: [127.0.0.1] => {"changed": true, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc user-create --password demo@123 --enabled demo\n", "delta": "0:00:01.503214", "end": "2020-06-19 09:24:33.089978", "rc": 0, "start": "2020-06-19 09:24:31.586764", "stderr": "", "stderr_lines": [], "stdout": "+-------------------+----------------------------------+\n|       Field       |              Value               |\n+-------------------+----------------------------------+\n| allow_web_console | true                             |\n| can_delete        | true                             |\n| can_update        | true                             |\n| created_at        | 2020-06-19T13:24:32.000000Z      |\n| credential_count  | 0                                |\n| deleted           | false                            |\n| domain_id         | default                          |\n| enable_mfa        | true                             |\n| enabled           | true                             |\n| failed_auth_count | 0                                |\n| group_count       | 0                                |\n| id                | 25b3572d974346328e116ece7417347b |\n| is_emulated       | false                            |\n| is_system_account | false                            |\n| name              | demo                             |\n| project_count     | 0                                |\n| project_domain    | Default                          |\n| update_version    | 0                                |\n| updated_at        | 2020-06-19T13:24:32.000000Z      |\n+-------------------+----------------------------------+", "stdout_lines": ["+-------------------+----------------------------------+", "|       Field       |              Value               |", "+-------------------+----------------------------------+", "| allow_web_console | true                             |", "| can_delete        | true                             |", "| can_update        | true                             |", "| created_at        | 2020-06-19T13:24:32.000000Z      |", "| credential_count  | 0                                |", "| deleted           | false                            |", "| domain_id         | default                          |", "| enable_mfa        | true                             |", "| enabled           | true                             |", "| failed_auth_count | 0                                |", "| group_count       | 0                                |", "| id                | 25b3572d974346328e116ece7417347b |", "| is_emulated       | false                            |", "| is_system_account | false                            |", "| name              | demo                             |", "| project_count     | 0                                |", "| project_domain    | Default                          |", "| update_version    | 0                                |", "| updated_at        | 2020-06-19T13:24:32.000000Z      |", "+-------------------+----------------------------------+"]}

TASK [primary-master-node : Update onecloud user demo password to demo@123] ***********************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:138
changed: [127.0.0.1] => {"changed": true, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc user-update --password demo@123 --enabled --allow-web-console demo\n", "delta": "0:00:01.321374", "end": "2020-06-19 09:24:34.906848", "rc": 0, "start": "2020-06-19 09:24:33.585474", "stderr": "", "stderr_lines": [], "stdout": "+-------------------+----------------------------------+\n|       Field       |              Value               |\n+-------------------+----------------------------------+\n| allow_web_console | true                             |\n| can_delete        | true                             |\n| can_update        | true                             |\n| created_at        | 2020-06-19T13:24:32.000000Z      |\n| credential_count  | 0                                |\n| deleted           | false                            |\n| domain_id         | default                          |\n| enable_mfa        | true                             |\n| enabled           | true                             |\n| failed_auth_count | 0                                |\n| group_count       | 0                                |\n| id                | 25b3572d974346328e116ece7417347b |\n| is_emulated       | false                            |\n| is_system_account | false                            |\n| name              | demo                             |\n| project_count     | 0                                |\n| project_domain    | Default                          |\n| update_version    | 0                                |\n| updated_at        | 2020-06-19T13:24:32.000000Z      |\n+-------------------+----------------------------------+", "stdout_lines": ["+-------------------+----------------------------------+", "|       Field       |              Value               |", "+-------------------+----------------------------------+", "| allow_web_console | true                             |", "| can_delete        | true                             |", "| can_update        | true                             |", "| created_at        | 2020-06-19T13:24:32.000000Z      |", "| credential_count  | 0                                |", "| deleted           | false                            |", "| domain_id         | default                          |", "| enable_mfa        | true                             |", "| enabled           | true                             |", "| failed_auth_count | 0                                |", "| group_count       | 0                                |", "| id                | 25b3572d974346328e116ece7417347b |", "| is_emulated       | false                            |", "| is_system_account | false                            |", "| name              | demo                             |", "| project_count     | 0                                |", "| project_domain    | Default                          |", "| update_version    | 0                                |", "| updated_at        | 2020-06-19T13:24:32.000000Z      |", "+-------------------+----------------------------------+"]}

TASK [primary-master-node : Make onecloud user demo as system admin] ******************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:143
changed: [127.0.0.1] => {"changed": true, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc project-add-user system demo admin\n", "delta": "0:00:01.121861", "end": "2020-06-19 09:24:36.534888", "rc": 0, "start": "2020-06-19 09:24:35.413027", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [primary-master-node : Check if admin network adm0 exists] ***********************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:148
ok: [127.0.0.1] => {"changed": false, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc network-show adm0 > /dev/null 2>&1\n", "delta": "0:00:01.148059", "end": "2020-06-19 09:24:38.185217", "failed_when_result": false, "msg": "non-zero return code", "rc": 1, "start": "2020-06-19 09:24:37.037158", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}

TASK [primary-master-node : Check if network contains 192.168.137.190] ****************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:157
changed: [127.0.0.1] => {"changed": true, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc network-list --ip 192.168.137.190 | grep -v Total | wc -l\n", "delta": "0:00:01.293203", "end": "2020-06-19 09:24:39.964917", "rc": 0, "start": "2020-06-19 09:24:38.671714", "stderr": "", "stderr_lines": [], "stdout": "0", "stdout_lines": ["0"]}

TASK [primary-master-node : set admin network count] **********************************************************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:164
ok: [127.0.0.1] => {"ansible_facts": {"admin_network_count": "0"}, "changed": false}

TASK [primary-master-node : Register adm0 network for 192.168.137.190/24, gateway 192.168.137.2] **************************************
task path: /root/ocboot/onecloud/roles/primary-master-node/tasks/main.yml:168
changed: [127.0.0.1] => {"changed": true, "cmd": "eval $(/opt/yunion/bin/ocadm cluster rcadmin)\n/opt/yunion/bin/climc network-create --gateway 192.168.137.2 --server-type baremetal bcast0 adm0 192.168.137.190 192.168.137.190 24\n/opt/yunion/bin/climc network-private adm0\n", "delta": "0:00:02.829742", "end": "2020-06-19 09:24:43.553069", "rc": 0, "start": "2020-06-19 09:24:40.723327", "stderr": "", "stderr_lines": [], "stdout": "+----------------------+--------------------------------------+\n|        Field         |                Value                 |\n+----------------------+--------------------------------------+\n| alloc_timout_seconds | 0                                    |\n| bm_nics              | 0                                    |\n| brand                | OneCloud                             |\n| can_delete           | true                                 |\n| can_update           | true                                 |\n| cloud_env            | onpremise                            |\n| cloudregion_id       | default                              |\n| created_at           | 2020-06-19T13:24:42.000000Z          |\n| deleted              | false                                |\n| domain_id            | default                              |\n| eip_vnics            | 0                                    |\n| exit                 | false                                |\n| group_vnics          | 0                                    |\n| guest_gateway        | 192.168.137.2                        |\n| guest_ip6_mask       | 0                                    |\n| guest_ip_end         | 192.168.137.190                      |\n| guest_ip_mask        | 24                                   |\n| guest_ip_start       | 192.168.137.190                      |\n| id                   | 823cc07c-7c2e-4bd6-85b8-96b207b80ea8 |\n| ifname_hint          | adm0                                 |\n| is_emulated          | false                                |\n| is_public            | false                                |\n| is_system            | false                                |\n| lb_vnics             | 0                                    |\n| name                 | adm0                                 |\n| pending_deleted      | false                                |\n| ports                | 1                                    |\n| ports_used           | 0                                    |\n| project_domain       | Default                              |\n| project_src          | local                                |\n| provider             | OneCloud                             |\n| public_scope         | none                                 |\n| region               | Default                              |\n| region_id            | default                              |\n| reserve_vnics        | 0                                    |\n| server_type          | baremetal                            |\n| status               | available                            |\n| tenant               | system                               |\n| tenant_id            | 8fb3820aeee245598b080580af2e20ed     |\n| update_version       | 1                                    |\n| updated_at           | 2020-06-19T13:24:42.000000Z          |\n| vlan_id              | 1                                    |\n| vnics                | 0                                    |\n| vpc                  | Default                              |\n| vpc_id               | default                              |\n| wire                 | bcast0                               |\n| wire_id              | f2b2cd2c-d712-4459-8c42-2ad50d6e5647 |\n| zone                 | zone0                                |\n| zone_id              | c467362b-74d3-4973-8a5b-71af48da4e34 |\n+----------------------+--------------------------------------+\n+----------------------+--------------------------------------+\n|        Field         |                Value                 |\n+----------------------+--------------------------------------+\n| alloc_timout_seconds | 0                                    |\n| bm_nics              | 0                                    |\n| brand                | OneCloud                             |\n| can_delete           | true                                 |\n| can_update           | true                                 |\n| cloud_env            | onpremise                            |\n| cloudregion_id       | default                              |\n| created_at           | 2020-06-19T13:24:42.000000Z          |\n| deleted              | false                                |\n| domain_id            | default                              |\n| eip_vnics            | 0                                    |\n| exit                 | false                                |\n| group_vnics          | 0                                    |\n| guest_gateway        | 192.168.137.2                        |\n| guest_ip6_mask       | 0                                    |\n| guest_ip_end         | 192.168.137.190                      |\n| guest_ip_mask        | 24                                   |\n| guest_ip_start       | 192.168.137.190                      |\n| id                   | 823cc07c-7c2e-4bd6-85b8-96b207b80ea8 |\n| ifname_hint          | adm0                                 |\n| is_emulated          | false                                |\n| is_public            | false                                |\n| is_system            | false                                |\n| lb_vnics             | 0                                    |\n| name                 | adm0                                 |\n| pending_deleted      | false                                |\n| ports                | 1                                    |\n| ports_used           | 0                                    |\n| project_domain       | Default                              |\n| project_src          | local                                |\n| provider             | OneCloud                             |\n| public_scope         | none                                 |\n| region               | Default                              |\n| region_id            | default                              |\n| reserve_vnics        | 0                                    |\n| server_type          | baremetal                            |\n| status               | available                            |\n| tenant               | system                               |\n| tenant_id            | 8fb3820aeee245598b080580af2e20ed     |\n| update_version       | 1                                    |\n| updated_at           | 2020-06-19T13:24:42.000000Z          |\n| vlan_id              | 1                                    |\n| vnics                | 0                                    |\n| vpc                  | Default                              |\n| vpc_id               | default                              |\n| wire                 | bcast0                               |\n| wire_id              | f2b2cd2c-d712-4459-8c42-2ad50d6e5647 |\n| zone                 | zone0                                |\n| zone_id              | c467362b-74d3-4973-8a5b-71af48da4e34 |\n+----------------------+--------------------------------------+", "stdout_lines": ["+----------------------+--------------------------------------+", "|        Field         |                Value                 |", "+----------------------+--------------------------------------+", "| alloc_timout_seconds | 0                                    |", "| bm_nics              | 0                                    |", "| brand                | OneCloud                             |", "| can_delete           | true                                 |", "| can_update           | true                                 |", "| cloud_env            | onpremise                            |", "| cloudregion_id       | default                              |", "| created_at           | 2020-06-19T13:24:42.000000Z          |", "| deleted              | false                                |", "| domain_id            | default                              |", "| eip_vnics            | 0                                    |", "| exit                 | false                                |", "| group_vnics          | 0                                    |", "| guest_gateway        | 192.168.137.2                        |", "| guest_ip6_mask       | 0                                    |", "| guest_ip_end         | 192.168.137.190                      |", "| guest_ip_mask        | 24                                   |", "| guest_ip_start       | 192.168.137.190                      |", "| id                   | 823cc07c-7c2e-4bd6-85b8-96b207b80ea8 |", "| ifname_hint          | adm0                                 |", "| is_emulated          | false                                |", "| is_public            | false                                |", "| is_system            | false                                |", "| lb_vnics             | 0                                    |", "| name                 | adm0                                 |", "| pending_deleted      | false                                |", "| ports                | 1                                    |", "| ports_used           | 0                                    |", "| project_domain       | Default                              |", "| project_src          | local                                |", "| provider             | OneCloud                             |", "| public_scope         | none                                 |", "| region               | Default                              |", "| region_id            | default                              |", "| reserve_vnics        | 0                                    |", "| server_type          | baremetal                            |", "| status               | available                            |", "| tenant               | system                               |", "| tenant_id            | 8fb3820aeee245598b080580af2e20ed     |", "| update_version       | 1                                    |", "| updated_at           | 2020-06-19T13:24:42.000000Z          |", "| vlan_id              | 1                                    |", "| vnics                | 0                                    |", "| vpc                  | Default                              |", "| vpc_id               | default                              |", "| wire                 | bcast0                               |", "| wire_id              | f2b2cd2c-d712-4459-8c42-2ad50d6e5647 |", "| zone                 | zone0                                |", "| zone_id              | c467362b-74d3-4973-8a5b-71af48da4e34 |", "+----------------------+--------------------------------------+", "+----------------------+--------------------------------------+", "|        Field         |                Value                 |", "+----------------------+--------------------------------------+", "| alloc_timout_seconds | 0                                    |", "| bm_nics              | 0                                    |", "| brand                | OneCloud                             |", "| can_delete           | true                                 |", "| can_update           | true                                 |", "| cloud_env            | onpremise                            |", "| cloudregion_id       | default                              |", "| created_at           | 2020-06-19T13:24:42.000000Z          |", "| deleted              | false                                |", "| domain_id            | default                              |", "| eip_vnics            | 0                                    |", "| exit                 | false                                |", "| group_vnics          | 0                                    |", "| guest_gateway        | 192.168.137.2                        |", "| guest_ip6_mask       | 0                                    |", "| guest_ip_end         | 192.168.137.190                      |", "| guest_ip_mask        | 24                                   |", "| guest_ip_start       | 192.168.137.190                      |", "| id                   | 823cc07c-7c2e-4bd6-85b8-96b207b80ea8 |", "| ifname_hint          | adm0                                 |", "| is_emulated          | false                                |", "| is_public            | false                                |", "| is_system            | false                                |", "| lb_vnics             | 0                                    |", "| name                 | adm0                                 |", "| pending_deleted      | false                                |", "| ports                | 1                                    |", "| ports_used           | 0                                    |", "| project_domain       | Default                              |", "| project_src          | local                                |", "| provider             | OneCloud                             |", "| public_scope         | none                                 |", "| region               | Default                              |", "| region_id            | default                              |", "| reserve_vnics        | 0                                    |", "| server_type          | baremetal                            |", "| status               | available                            |", "| tenant               | system                               |", "| tenant_id            | 8fb3820aeee245598b080580af2e20ed     |", "| update_version       | 1                                    |", "| updated_at           | 2020-06-19T13:24:42.000000Z          |", "| vlan_id              | 1                                    |", "| vnics                | 0                                    |", "| vpc                  | Default                              |", "| vpc_id               | default                              |", "| wire                 | bcast0                               |", "| wire_id              | f2b2cd2c-d712-4459-8c42-2ad50d6e5647 |", "| zone                 | zone0                                |", "| zone_id              | c467362b-74d3-4973-8a5b-71af48da4e34 |", "+----------------------+--------------------------------------+"]}
META: ran handlers
META: ran handlers

PLAY RECAP ****************************************************************************************************************************
127.0.0.1                  : ok=61   changed=18   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0


```